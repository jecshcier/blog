---
title: ç»™disqusè¯„è®ºç³»ç»Ÿæ·»åŠ åå‘ä»£ç†ï¼Œå¢™å†…ç”¨æˆ·è®¿é—®
categories: hexo
date: 2017-10-03 15:24:57
tags: [hexo]
keywords: [disqus,åå‘ä»£ç†]
---

å‰æ®µæ—¶é—´æŠ˜è…¾äº†ä¸€ä¸‹hexoï¼Œå¼„å®Œäº†å¤§æ¦‚é…ç½®ä¹‹åï¼Œå‡†å¤‡æŒ‘ä¸€ä¸ªè¯„è®ºç³»ç»Ÿï¼Œçº ç»“äº†åŠå¤©ï¼Œå‘ç°å›½å†…å¯é€‰çš„å„ç§è¯„è®ºç³»ç»Ÿéƒ½å·²ç»æŒ‚æ‰ã€‚ã€‚ã€‚

å¼„äº†ä¸ªgitmentï¼Œæ„Ÿè§‰ä¸Šokï¼Œä½†æ€»æœ‰ä¸€ç§è¯´ä¸ä¸Šçš„è¯¡å¼‚æ„Ÿã€‚ã€‚ä»Šå¤©ç¨å¾®äº†è§£äº†ä¸€ä¸‹disqusï¼ŒæŠŠè¯„è®ºç³»ç»Ÿæ¢æˆäº†disqusçš„ï¼Œç¼ºç‚¹åœ¨äºå¢™å†…ç”¨æˆ·è®¿é—®ä¸äº†ã€‚

ä½†è¿™ä¸ªä¼¼ä¹æ˜¯å¯ä»¥ç”¨åå‘ä»£ç†è§£å†³çš„ï¼Œæœºæ™ºçš„æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªgitä»“åº“ã€‚

<a href="https://github.com/ciqulover/disqus-proxy">disqus-proxy</a>

gitä¸Šæœ‰å…·ä½“è¯´æ˜ï¼Œè¿™é‡Œå°±ä¸è§£é‡Šäº†ã€‚

<!--more--->

ç”±äºæˆ‘ç”¨çš„æ˜¯nextçš„çš®è‚¤ï¼Œè¿™é‡Œä¼šéœ€è¦æ›¿æ¢ä¸€æ®µä»£ç 

```
{% if true %}
  <div id="disqus_proxy_thread"></div>
  <div id="disqus_thread">
  <script type="text/javascript">
        window.disqusProxy = {
          shortname: 'ciqu',
          server: 'disqus-proxy.ycwalker.com',
          port: 5509,
          defaultAvatar: '/avatars/default-avatar.png',
          adminAvatar: '/avatars/admin-avatar.jpg',
          identifier: '{{ page.path }}'
        };
        window.disqus_config = function () {
          this.page.url = '{{ page.permalink }}';
          this.page.identifier = '{{ page.path }}';
        };
        var s = document.createElement('script');
        s.src = '/static/js/disqus-proxy.js';
        s.async = true;
        document.body.appendChild(s);
    </script>
{% endif %}
```

æ³¨æ„ï¼Œè¿™é‡Œçš„ä»£ç `<div id="disqus_thread">`çš„æ ‡ç­¾ï¼Œå±…ç„¶æ¼äº†ä¸€ä¸ª`</div>`ï¼Œä»¥è‡³äºè®©æˆ‘ç•Œé¢çš„æ ·å¼é”™ä¹±ï¼Œæµªè´¹äº†ä¸€ä¸ªå¤šå°æ—¶çš„æ—¶é—´å»è°ƒã€‚

æ³¨æ„ï¼Œè¿™é‡Œçš„

```
{% if true %}
```

å„ä¸ç›¸åŒï¼Œæˆ‘è¿™é‡Œæ˜¯

```
{% elseif theme.disqus.enable %}
```

è´´ä¸Šæ­£å¸¸çš„ä»£ç 

```
{% if true %}
  <div id="disqus_proxy_thread"></div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
        window.disqusProxy = {
          shortname: 'ciqu',
          server: 'disqus-proxy.ycwalker.com',
          port: 5509,
          defaultAvatar: '/avatars/default-avatar.png',
          adminAvatar: '/avatars/admin-avatar.jpg',
          identifier: '{{ page.path }}'
        };
        window.disqus_config = function () {
          this.page.url = '{{ page.permalink }}';
          this.page.identifier = '{{ page.path }}';
        };
        var s = document.createElement('script');
        s.src = '/static/js/disqus-proxy.js';
        s.async = true;
        document.body.appendChild(s);
    </script>
{% endif %}
```

è¿™é‡Œæœ‰å‡ ä¸ªæ¯”è¾ƒå¤æ‚çš„åœ°æ–¹ã€‚ç®€å•è®²å‡ å¥ï¼Œä¸€ä¸ªæ˜¯apiçš„secretè·å–ï¼Œæœ¬äººè‹±è¯­ç•¥æ¸£ï¼Œè¿™ä¸ªåå‘ä»£ç†çš„åº“é‡Œä¹Ÿæ²¡è®²æ¸…åœ¨å“ªé‡Œç”³è¯·è¿™ä¸ªkeyï¼Œgoogleäº†ä¸€æŠŠï¼Œåœ¨è¿™é‡Œæ·»åŠ disqusçš„application
<https://disqus.com/api/applications/>

ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªè¯¡å¼‚çš„é—®é¢˜ï¼Œå°†ä»“åº“é‡Œçš„staticæ–‡ä»¶å¤¹æ”¾åˆ°hexoæ ¹ç›®å½•çš„sourceæ–‡ä»¶å¤¹ä¹‹åï¼Œç»è¿‡hexoçš„æ¸²æŸ“ï¼Œ`disqus-proxy.js`çš„530è¡Œä¸€ç›´è¢«æ¸²æˆè¯¡å¼‚çš„ä¸€è¡Œï¼Œä¸€ç›´åœ¨æŠ¥é”™ã€‚ã€‚ã€‚ğŸ˜“é‚æœäº†ä¸€ä¸‹ï¼Œåœ¨hexoçš„configæ–‡ä»¶é‡Œå°†`skip_render:`è¿™ä¸€è¡Œå†™æˆ`skip_render: static/**`å°±å¥½äº†ã€‚

çœ‹äº†ä¸‹æ•ˆæœï¼Œè¿˜æ˜¯ä¸é”™çš„ï¼Œé»˜è®¤çš„å¤´åƒå¯ä»¥åœ¨avatarsæ–‡ä»¶å¤¹é‡Œæ›´æ”¹ï¼Œæ”¹æˆåŒåæ–‡ä»¶å°±okäº†ï½



--è¿™é‡Œè¡¥å……ä¸‹--

åˆšåˆšæŠ•é€’ä¸Šå»æ‰å‘ç°åœ¨æ²¡æœ‰è¯„è®ºçš„æ—¶å€™å±…ç„¶ä¼šå¼¹ä¸€ä¸ªnotificationã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚orzï¼Œå¼¹å°±å¼¹äº†ï¼Œå®ƒè¿˜ä¸èƒ½æ¶ˆå¤±ï¼Œè€Œä¸”æŠ¥çš„æ˜¯è·å–è¯„è®ºé”™è¯¯  --> **è¿™æ˜æ˜æ˜¯æ²¡æœ‰è¯„è®ºå¥½ä¸å¥½ï¼**

æ‰’å¼€æºç çœ‹äº†çœ‹ï¼Œå…¶å®ä½œè€…è¿˜æ˜¯æŒºç”¨å¿ƒçš„ï¼Œä¼°è®¡å¿˜äº†å†™äº†å§ã€‚åœ¨`static/js/disqus-proxy.js`é‡Œæœç´¢ä¸€ä¸‹"è¯„è®ºè·å–é”™è¯¯"ï¼Œå°±å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹

```
								case 9:
									i = e.sent, this.setState({
										isFetchingComment: !1
									}), 0 === i.code ? this.setState({
										comments: i.response
									}) : this.setState({
										notificationTitle: "è¯„è®ºè·å–é”™è¯¯",
										notificationBody: i.response,
										showNotification: !0
									}), e.next = 17;
									break;
								case 14:
									e.prev = 14, e.t0 = e.catch(3), this.setState({
										isFetchingComment: !1,
										notificationTitle: "è¯„è®ºè·å–é”™è¯¯",
										notificationBody: e.t0,
										showNotification: !0
									});
```

æŠŠ`showNotification`éƒ½æ”¹æˆ`!1`å°±å¯ä»¥äº†ã€‚

è®²çœŸæˆ‘å¹¶ä¸æ˜¯å–œæ¬¢æ”¹åˆ«äººæºç çš„äººï¼Œå‡†å¤‡å»æä¸ªissue~å°±è¿™æ ·